<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kolob Prime — Minecraft Server</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 32rem;
      margin: 2rem auto;
      padding: 0 1rem;
      color: #1a1a1a;
      line-height: 1.5;
    }
    h1 { font-size: 1.75rem; margin-bottom: 0.25rem; }
    h2 { font-size: 1rem; margin: 1.5rem 0 0.5rem; color: #333; }
    p { color: #444; margin: 0 0 1rem; }
    .tagline { color: #666; font-size: 0.95rem; margin-bottom: 1.5rem; }
    ul { color: #444; margin: 0 0 1rem; padding-left: 1.25rem; }
    li { margin-bottom: 0.25rem; }
    .contact { background: #f5f5f5; padding: 0.75rem 1rem; border-radius: 6px; margin: 1rem 0; font-size: 0.95rem; }
    .contact a { color: #1967d2; }
    button {
      font-size: 1rem;
      padding: 0.6rem 1.2rem;
      background: #2d7d46;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 0.5rem;
    }
    button:hover { background: #236b3a; }
    button:disabled {
      background: #888;
      cursor: not-allowed;
    }
    #message {
      margin-top: 1rem;
      padding: 0.75rem;
      border-radius: 6px;
      min-height: 2.5rem;
    }
    #message.success { background: #e6f4ea; color: #0d652d; }
    #message.error { background: #fce8e6; color: #c5221f; }
    #message.info { background: #e8f0fe; color: #1967d2; }
  </style>
</head>
<body>
  <h1>Kolob Prime</h1>
  <p class="tagline">Minecraft Java — Survival, Hard mode</p>

  <p>This server runs on demand. Use the button below to start it; after a few minutes you can connect from Minecraft.</p>

  <h2>Server info</h2>
  <ul>
    <li><strong>World:</strong> Kolob Prime</li>
    <li><strong>Game mode:</strong> Survival</li>
    <li><strong>Difficulty:</strong> Hard</li>
    <li><strong>Max players:</strong> 20</li>
    <li><strong>PvP:</strong> Enabled</li>
    <li><strong>Whitelist:</strong> Yes — you must be added to join</li>
  </ul>

  <h2>How to play</h2>
  <ol style="margin: 0 0 1rem; padding-left: 1.25rem; color: #444;">
    <li style="margin-bottom: 0.25rem;">Click <strong>Start server</strong> below.</li>
    <li style="margin-bottom: 0.25rem;">Wait a few minutes for the server to spin up.</li>
    <li style="margin-bottom: 0.25rem;">In Minecraft (Java), go to Multiplayer → Add Server or Direct Connect.</li>
    <li>Connect to <strong>minecraft.metacannon.net</strong> (port 25565).</li>
  </ol>

  <div class="contact">
    <strong>Want to join?</strong> The server is whitelisted. Contact <a href="mailto:lincoln@metacannon.net">Lincoln (lincoln@metacannon.net)</a> to be added.
  </div>

  <button type="button" id="startBtn">Start Server</button>
  <div id="message" role="status" aria-live="polite"></div>

  <script>
    (function () {
      // Replace this with the StartServerUrl from CDK deploy output (minecraft-domain-stack)
      const START_SERVER_URL = 'https://bujltafei2riubshu2a2wzo4gy0dtwhx.lambda-url.us-east-1.on.aws/';

      const btn = document.getElementById('startBtn');
      const msg = document.getElementById('message');

      function show(text, type) {
        msg.textContent = text;
        msg.className = type || 'info';
      }

      function setBusy(busy) {
        btn.disabled = busy;
      }

      btn.addEventListener('click', async function () {
        if (START_SERVER_URL === 'REPLACE_WITH_START_SERVER_URL') {
          show('Start URL not configured. Set START_SERVER_URL in index.html from CDK deploy output.', 'error');
          return;
        }
        setBusy(true);
        show('Starting…', 'info');
        try {
          const res = await fetch(START_SERVER_URL, { method: 'POST' });
          const data = await res.json().catch(() => ({}));
          if (res.ok) {
            show(data.message || 'Server start requested. Give it a few minutes, then connect to minecraft.metacannon.net in Minecraft.', 'success');
          } else {
            show(data.message || 'Request failed. Try again or check the console.', 'error');
          }
        } catch (e) {
          show('Network error: ' + e.message, 'error');
        } finally {
          setBusy(false);
        }
      });
    })();
  </script>
</body>
</html>
